{% extends "chaoslegion/base.html" %}
{% load staticfiles %}

{% block content %}
    
<div id="page"  class="postPage">

<div class="subnav">  
  <div class="row">
    <div class="large-9 columns">
      <a> Hot </a>
      <a> New </a>
      <a> Top </a>

      <!-- All by default, while few users. Later add subscriptions.
      <a>|</a>
      <a> Subscribed </a>
      <a> All </a>
      <!-- <a> Search </a> TODO: intersection of multiple hubs. -->
      
    </div>
    <!-- <div class="large-3 columns">
      <div class="username" /> <a href="/user/"><b>rayalez</b></a> </div>
      <div class="fi-mail usermail"></div>
      <div class="userkarma">129</div>
      <div class="followers">28</div>
      <img class="logout" src="{% static "/static/img/logout.png" %}"/>
      </div> -->
  </div>
</div>

  <div class="row">
    <div class="large-12 columns">
      {% for post in posts %}
      <article>
	<!-- Vote -->
	<div class="vote-column">
	  <div class="vote">
	    <a href="/login/" class="fi-arrow-up upvote {% if post in upvoted %}voted{% endif %}" id="post-vote-{{post.id}}"></a>
	    <div class="score"> {{post.score}} </div>
	    <a href="/downvote/" class="fi-arrow-down"></a>	    
	  </div>
	<!-- Comments -->
	  <div class="post-comments">
	    <span class="fi-comment">
	      <span class="number-of-comments"> 183 </span>
	    </span>			      
	  </div>
	</div>	    	  
	<!-- Post Header -->
	<header class="post-header">
	  <a href="{{ post.get_absolute_url }}">
	    <h1> {{post.title}} </h1>
	  </a>
	    <span class="post-tagline">submitted 14 days ago by {{post.author}}</span>
	    <hr />
	</header>
	<!-- Post Body -->
	{{post.body}}      	
	<div>
      </article>
      {% endfor %}
      
      <article>
	<!-- Vote -->
	<div class="vote-column">
	  <div class="vote">
	    <div class="fi-arrow-up"></div>
	    <div class="score"> 114 </div>
	    <div class="fi-arrow-down"></div>	    
	  </div>
	<!-- Comments -->
	  <div class="post-comments">
	    <span class="fi-comment">
	      <span class="number-of-comments"> 183 </span>
	    </span>			      
	  </div>
	</div>	    	  
	<!-- Post Header -->
	<header class="post-header">
	    <h1> House Ambaret </h1>
	    <span class="post-tagline">submitted 14 days ago by Luna_LoveWell</span>

	    <hr />
	</header>
	<!-- Post Body -->
	<div>
	<b> [EU] For generations, Hogwarts students have been divided into four houses. As you sit beneath the Sorting Hat, you become the first student chosen for a mysterious fifth house. </b>

	<p>"My word," the Hat said. "What a peculiar mind.  I certainly do love a challenge! Let's see what we have to work with here. Smart, certainly. But you're not the Ravenclaw type. They care only for books and spells, not creativity and ingenuity. Hufflepuff is a possibility; you seem like a fine fellow. But there's a vein of courage and pride that that dear Helga would not have approved of. No, no: that's Gryffindor's expertise."</p>

	<p>My eyes lit up as he said Gryffindor, and the front row of the Great Hall tensed up as if expecting the announcement to come soon. Everyone wanted to be in Gryffindor; that was the house of Harry and Hermoine and Ron! </p>

	<p>"They'd certainly love to have you, I'm sure. But I don't think it would be the right fit. You seem to be more cautious and calculating than some of those headstrong lugs. Slytherin, perhaps? I think not; I don't sense the manipulative ambition in you. You have pride, but not arrogance. You have desire, but not greed. My my, a strange specimen indeed."</p>
	</div>	
      </article>


      <article>
	<!-- Vote -->
	<div class="vote-column">
	  <div class="vote">
	    <div class="fi-arrow-up"></div>
	    <div class="score"> 430 </div>
	    <div class="fi-arrow-down"></div>	    
	  </div>
	<!-- Comments -->
	  <div class="post-comments">
	    <span class="fi-comment">
	      <span class="number-of-comments"> 378 </span>
	    </span>			      
	  </div>
	</div>	    	  
	<!-- Post Header -->
	<header class="post-header">
	    <h1> The Devils Own Space-Cowboy </h1>
	    <span class="post-tagline">submitted 6 days ago by NaimKabir</span>
	    <hr />
	</header>
	<!-- Post Body -->	
	<div>



<div class="usertext-body may-blank-within md-container "><div class="md"><p><a href="http://www.reddit.com/r/WritingPrompts/comments/35q6cs/wp_you_sold_your_soul_to_the_devil_some_years_ago/cr6s0h6"><strong>Prompt: You sold your soul to the Devil some years ago. Today he gives it back and says, "I need a favor."</strong></a></p>

<p>His voice is difficult to describe.</p>

<p>Picture this: your eardrum is a cigarette filter and his mouth is the burning sunspot of the lit end.</p>

<p>Whenever he speaks, it’s like your brain’s taking a long, long drag.</p>

<p><em>”Remember that little deal we had a while back?”</em></p>

<p>Deal? More like ‘scam’. “The deal we made when I was just a kid? <em>Yeah,</em> I remember that deal.”</p>

<p><em>”Whoa, now,”</em> he said. <em>”I’m detecting a little bit of acid in your speech, there. You angry about something?”</em></p>

<p>“You made a deal with an eight year-old, you colossal douchebag. I wanted to be a ‘space cowboy’, and you took my soul over that?” I shook my head. “What the hell, man?”</p>

<p><em>“Right. About that...”</em> He smiled and it was like watching a crack form in the glacial north arctic. Every time he did it you just knew that some polar bear was getting his life screwed over. <em>“Turns out,”</em> he said, with that same smile, <em>“that your little eight year-old fantasy may not be so useless after all.”</em></p>

<p>I turned around and started locking up the drawers. I was closing up the coffee shop tonight. “Get to the point, Devil.”</p>

<p>His eyes glimmered with some inner light. <em>“Well, I have a particularly difficult task I need your expertise with. I need some space cowboying done.”</em></p>

<p>“You’re shitting me.”</p>

	</div>	
      </article>      
      
      
    </div> <!-- End 12 columns -->
      </div>	 <!-- End row -->



<script>
    $(document).ready(function(){
	// getting csrf token.
	function getCookie(name) {
	    var cookieValue = null;
	    if (document.cookie && document.cookie != '') {
		var cookies = document.cookie.split(';');
		for (var i = 0; i < cookies.length; i++) {
		    var cookie = jQuery.trim(cookies[i]);
		    // Does this cookie string begin with the name we want?
		    if (cookie.substring(0, name.length + 1) == (name + '=')) {
			cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
			break;
		    }
		}
	    }
	    return cookieValue;
	}
	var csrftoken = getCookie('csrftoken');
	
	function upvote(postId) {
	    $.ajax({
		type: "POST",
		url: "/upvote/",
		data: {"post-id": postId},
		success: function(){
		    var upvoteLink = $('#post-vote-'+postId);
		    upvoteLink.addClass('voted');
		    var score = upvoteLink.parent().find(".score");
                    var notUpdated = Number(score.html());
                    score.html(notUpdated + 1);
		    upvoteLink.off("click");
		    upvoteLink.click(function(){ return false;});
		},
		headers: {
		    'X-CSRFToken': csrftoken
		}
	    });
	    return false;
	}

	{% if user.is_authenticated %}
	$("a.upvote").click(function(){
	    var postId = parseInt(this.id.split("-")[2]);
	    return upvote(postId);
	})
	$("a.voted").off("click");
        $("a.voted").click(function(){ return false;});
	{% endif %}
    })
</script>
{% endblock content %}


